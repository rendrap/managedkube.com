<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Using the AWS CLI - find and terminate an EC2 Instance | ManagedKube</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Using the AWS CLI - find and terminate an EC2 Instance" />
<meta name="author" content="Garland Kan" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Reducing Your Kubernetes Cloud Costs" />
<meta property="og:description" content="Reducing Your Kubernetes Cloud Costs" />
<link rel="canonical" href="http://localhost:4000/aws/cli/ec2/2018/08/16/aws-cli-find-and-terminate-instance.html" />
<meta property="og:url" content="http://localhost:4000/aws/cli/ec2/2018/08/16/aws-cli-find-and-terminate-instance.html" />
<meta property="og:site_name" content="ManagedKube" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-08-16T00:00:00-07:00" />
<script type="application/ld+json">
{"description":"Reducing Your Kubernetes Cloud Costs","author":{"@type":"Person","name":"Garland Kan"},"@type":"BlogPosting","url":"http://localhost:4000/aws/cli/ec2/2018/08/16/aws-cli-find-and-terminate-instance.html","headline":"Using the AWS CLI - find and terminate an EC2 Instance","dateModified":"2018-08-16T00:00:00-07:00","datePublished":"2018-08-16T00:00:00-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/aws/cli/ec2/2018/08/16/aws-cli-find-and-terminate-instance.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="theme-color" content="#ffffff"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="ManagedKube" /><script type="text/javascript">
  	$(document).ready(function(){

  		$('label[for="nav-trigger"]').click(function() {
  			$('body').toggleClass('nav-open');
  		})
      var pathName = window.location.pathname;
      // alert('[href= "'" + pathName + "'"]');
      $('.page-link').removeClass('page-linkactive');
      $(".page-link[href='" + pathName + "']").addClass('page-linkactive');
  	});
  </script>

</head>
<body><header class="site-header" role="banner">

  <div class="wrapper">
    <div class="section"><a class="site-title" rel="author" href="/">
        <img src="/assets/images/ManagedKube-Logo.png">
      </a><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger" />
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewBox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
              </svg>
            </span>
          </label>

          <div class="trigger">
            <a class="page-link" href="/">Kubernetes Cost Attribution</a>
            <a class="page-link" href="/blog/">Blog</a>
            <a class="page-link" href="/start-free-trail">Start Free Trial</a></div>

        </nav></div>
  </div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <div class="post-wrap">
    <div class="post-container">
      <header class="post-header">
        <h1 class="post-title p-name" itemprop="name headline">Using the AWS CLI - find and terminate an EC2 Instance</h1>
        <div class="meta-wrap">
          <p class="post-author"></p>
          <time class="dt-published" datetime="2018-08-16T00:00:00-07:00" itemprop="datePublished">Aug 16, 2018
          </time>
<!---->
        </div>
      </header>

      <div class="post-content e-content" itemprop="articleBody">
        <p><img src="http://localhost:4000/assets/blog/images/delete-button.jpg" alt="Delete" /></p>

<p>Sometimes you need to delete an EC2 instance but dont want to go into the AWS
web console.  Most of the time you will have the internal DNS hostname of the instance
which would looks something like: <code class="highlighter-rouge">ip-10-151-21-159.ec2.internal</code>.</p>

<p>The AWS CLI doesnt let you terminate a node by a hostname.  It requires the
instance ID.  So the first task is to find the instance ID and then terminate it</p>

<p>You can find the instance ID by describing an instance and filtering on the <code class="highlighter-rouge">private-dns-name</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aws ec2 describe-instances <span class="nt">--filters</span> <span class="s2">"Name=private-dns-name,Values=ip-10-151-21-159.ec2.internal"</span>
</code></pre></div></div>

<p>This will give you a big JSON output.  Look for this key: <code class="highlighter-rouge">InstanceId</code>.</p>

<p>If you have <a href="https://stedolan.github.io/jq/">jq</a> installed, you can do this to rip it
right out of the json:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aws ec2 describe-instances <span class="nt">--filters</span> <span class="s2">"Name=private-dns-name,Values=ip-10-151-21-159.ec2.internal"</span> | jq <span class="nt">-r</span> .Reservations[0].Instances[0].InstanceId
</code></pre></div></div>

<p>To terminate the instance, you simply run:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aws ec2 terminate-instances <span class="nt">--instance-ids</span> i-07a8839d40f993baa
</code></pre></div></div>

<p>Replacing it with your instance ID.</p>

<!--         <p class="post-keywords">aws | cli | ec2</p>
 -->  
          <p class="post-keywords">aws | cli | ec2</p>
      </div><a class="u-url" href="/aws/cli/ec2/2018/08/16/aws-cli-find-and-terminate-instance.html" hidden></a>
    </div>
    
    <!-- Pagination links -->
    <div class="pagination">
      
        <a href="/kubernetes/service/external/2018/07/19/kubernetes-accessing-external-services.html" class="previous">< Previous</a>
      
      <a class="view-all" href="/blog">View All</a>
      
        <a href="/kubernetes/cron/job/2018/08/31/kubernetes-running-cronjob.html" class="next">Next > </a>
      
    </div>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <p class="footer-heading">Â© 2018 ManagedKube</p>



  </div>

  <script type="text/javascript">
var $zoho=$zoho || {};$zoho.salesiq = $zoho.salesiq ||
{widgetcode:"2e41d21e243a88a4440cf6ccf88eb5922a8ca33fed01b21cc1fb19cd7cbea9f35d5fe629768af6d9a03793700d9418c2", values:{},ready:function(){}};
var d=document;s=d.createElement("script");s.type="text/javascript";s.id="zsiqscript";s.defer=true;
s.src="https://salesiq.zoho.com/widget";t=d.getElementsByTagName("script")[0];t.parentNode.insertBefore(s,t);d.write("<div id='zsiqwidget'></div>");
</script>


</footer>
</body>

</html>
